<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Skipper: /home/debian/Skipper/src/include/classes/Tracer.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Skipper
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b0856f6b0d80ccb263b2f415c91f9e17.html">include</a></li><li class="navelem"><a class="el" href="dir_6c869b1ee59a41f6df78e962396b3582.html">classes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Tracer.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classTracer.html" title="Class, that inserts tracing function in basic blocks.">Tracer</a> class description.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="Config_8h_source.html">Config.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Tracer.h:</div>
<div class="dyncontent">
<div class="center"><img src="Tracer_8h__incl.png" border="0" usemap="#a_2home_2debian_2Skipper_2src_2include_2classes_2Tracer_8h" alt=""/></div>
<map name="a_2home_2debian_2Skipper_2src_2include_2classes_2Tracer_8h" id="a_2home_2debian_2Skipper_2src_2include_2classes_2Tracer_8h">
<area shape="rect" title="Tracer class description." alt="" coords="682,5,846,61"/>
<area shape="rect" href="Config_8h.html" title="Config class description." alt="" coords="727,109,801,136"/>
<area shape="rect" title=" " alt="" coords="255,333,329,360"/>
<area shape="rect" title=" " alt="" coords="855,408,935,435"/>
<area shape="rect" title=" " alt="" coords="877,184,920,211"/>
<area shape="rect" title=" " alt="" coords="5,408,64,435"/>
<area shape="rect" title=" " alt="" coords="959,408,1022,435"/>
<area shape="rect" title=" " alt="" coords="944,184,1091,211"/>
<area shape="rect" href="types_8h.html" title=" " alt="" coords="748,408,831,435"/>
<area shape="rect" href="loggers_8h.html" title=" " alt="" coords="511,184,617,211"/>
<area shape="rect" title=" " alt="" coords="712,483,787,509"/>
<area shape="rect" href="Logger_8h.html" title="Logger class." alt="" coords="391,259,571,285"/>
<area shape="rect" title=" " alt="" coords="353,333,444,360"/>
<area shape="rect" href="funcs_8h.html" title=" " alt="" coords="519,333,601,360"/>
<area shape="rect" title=" " alt="" coords="88,408,163,435"/>
<area shape="rect" title=" " alt="" coords="187,408,255,435"/>
<area shape="rect" title=" " alt="" coords="280,408,363,435"/>
<area shape="rect" title=" " alt="" coords="387,408,459,435"/>
<area shape="rect" title=" " alt="" coords="483,408,538,435"/>
<area shape="rect" title=" " alt="" coords="562,408,673,435"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="Tracer_8h__dep__incl.png" border="0" usemap="#a_2home_2debian_2Skipper_2src_2include_2classes_2Tracer_8hdep" alt=""/></div>
<map name="a_2home_2debian_2Skipper_2src_2include_2classes_2Tracer_8hdep" id="a_2home_2debian_2Skipper_2src_2include_2classes_2Tracer_8hdep">
<area shape="rect" title="Tracer class description." alt="" coords="5,5,169,61"/>
<area shape="rect" href="client_8cpp.html" title=" " alt="" coords="5,109,169,151"/>
</map>
</div>
</div>
<p><a href="Tracer_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCodeSegmentDescriber.html">CodeSegmentDescriber</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">just pair-structure &lt;code segment start offset, code segment end offset&gt;  <a href="structCodeSegmentDescriber.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTraceArea.html">TraceArea</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">extra-counters section (memory area for extra trace for libfuzzer), contains bounds and size.  <a href="structTraceArea.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTracer.html">Tracer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class, that inserts tracing function in basic blocks.  <a href="classTracer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a123d1a69b9cc1c4ef9d6cfa21c8660e5"><td class="memItemLeft" align="right" valign="top"><a id="a123d1a69b9cc1c4ef9d6cfa21c8660e5" name="a123d1a69b9cc1c4ef9d6cfa21c8660e5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_msb_ind</b> (uint x)</td></tr>
<tr class="memdesc:a123d1a69b9cc1c4ef9d6cfa21c8660e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">gets most signifant bit of <code>x</code> digit <br /></td></tr>
<tr class="separator:a123d1a69b9cc1c4ef9d6cfa21c8660e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50d52849f73aeaddc776d9de6fbeac5a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Tracer_8h.html#a50d52849f73aeaddc776d9de6fbeac5a">trace_overflow</a> (int *offset_int_ptr, uint32_t size, uint32_t ind, uint32_t reg_id)</td></tr>
<tr class="memdesc:a50d52849f73aeaddc776d9de6fbeac5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">trace function for clean-call  <a href="Tracer_8h.html#a50d52849f73aeaddc776d9de6fbeac5a">More...</a><br /></td></tr>
<tr class="separator:a50d52849f73aeaddc776d9de6fbeac5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac543296ab3c51210dd61838f989023a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Tracer_8h.html#ac543296ab3c51210dd61838f989023a8">insert_tracing</a> (void *drcontext, void *tag, instrlist_t *bb, instr_t *where, char *offset, uint32_t size, uint32_t ind, uint32_t reg_id)</td></tr>
<tr class="memdesc:ac543296ab3c51210dd61838f989023a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for inline ASM insertion.  <a href="Tracer_8h.html#ac543296ab3c51210dd61838f989023a8">More...</a><br /></td></tr>
<tr class="separator:ac543296ab3c51210dd61838f989023a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p ><a class="el" href="classTracer.html" title="Class, that inserts tracing function in basic blocks.">Tracer</a> class description. </p>
<dl class="section author"><dt>Author</dt><dd>Stepan Kafanov </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2025-03-31</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2025 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac543296ab3c51210dd61838f989023a8" name="ac543296ab3c51210dd61838f989023a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac543296ab3c51210dd61838f989023a8">&#9670;&nbsp;</a></span>insert_tracing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void insert_tracing </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>drcontext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">instrlist_t *&#160;</td>
          <td class="paramname"><em>bb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">instr_t *&#160;</td>
          <td class="paramname"><em>where</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>reg_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for inline ASM insertion. </p>
<p >Inserts ASM instraction directly before tracing ASM-instruction. Functional is the same as in trace_overflow function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">drcontext</td><td>- DR context </td></tr>
    <tr><td class="paramname">tag</td><td>- DR tag </td></tr>
    <tr><td class="paramname">bb</td><td>- current basic block </td></tr>
    <tr><td class="paramname">where</td><td>- current ASM instruction </td></tr>
    <tr><td class="paramname">offset</td><td>- trace-memory address </td></tr>
    <tr><td class="paramname">size</td><td>- trace-memory size </td></tr>
    <tr><td class="paramname">ind</td><td>- tracing instruction's index </td></tr>
    <tr><td class="paramname">reg_id</td><td>- register ID in DynamoRIO </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a50d52849f73aeaddc776d9de6fbeac5a" name="a50d52849f73aeaddc776d9de6fbeac5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50d52849f73aeaddc776d9de6fbeac5a">&#9670;&nbsp;</a></span>trace_overflow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int trace_overflow </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>offset_int_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>reg_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>trace function for clean-call </p>
<p >This function will be called before each instruction client is tracing. It uses buffer of size 65 bytes to trace MSB (most significant bit) of tracing instruction operand and current carry flag from flag register.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offset_int_ptr</td><td>- trace-memory address </td></tr>
    <tr><td class="paramname">size</td><td>- trace-memory size </td></tr>
    <tr><td class="paramname">ind</td><td>- tracing instruction's index </td></tr>
    <tr><td class="paramname">reg_id</td><td>- register ID in DynamoRIO </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 - error code </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
